<!DOCTYPE html>
<html>
<head>
  <title>Shape App</title>
  <meta charset="utf-8">
  <!-- import bootstrap 5.1 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/b33dd8950a.js" crossorigin="anonymous"></script>
</head>
<body>
  <div class="jumbotron" style="justify-content: center; text-align: center;">
  
  <h1 class="pt-4">Shape App</h1>
  <h3 id="connection-status"></h3>
  <div class="py-3">
    <button class="btn btn-primary" id="connectButton">Connect to Arduino</button>
    <button class="btn btn-danger" onclick="sendData('000000000000000000000000000000000000')">Clear Display</button>
  </div>
  <div class="pt-2">
    <button class="btn btn-primary p-3 m-1" onclick="sendData('001100010010100001100001010010001100')">
      <p>Send Circle</p>
      <i class="fa-regular fa-circle fa-3x"></i>
    </button>
    <button class="btn btn-primary p-3 m-1" onclick="sendData('111111100001100001100001100001111111')">
      <p>Send Square</p>
      <i class="fa-regular fa-square fa-3x"></i>
    </button>
    <button class="btn btn-primary p-3 m-1" onclick="sendData('001000010100100010111110000000000000')">
      <p>Send Triangle</p>
      <i class="fa-solid fa-caret-up fa-3x"></i>
    </button>
    <button class="btn btn-primary p-3 m-1" onclick="sendData('010100101010100010010100001000000000')">
      <p>Send Heart</p>
      <i class="fa-solid fa-heart fa-3x"></i>
    </button>
    <button class="btn btn-primary p-3 m-1" onclick="sendData('100010010100001000010100100010000000')">
      <p>Send X-Cross</p>
      <i class="fa-solid fa-times fa-3x"></i>
    </button>
    <button class="btn btn-primary p-3 m-1" onclick="sendData('001000001000111110001000001000000000')">
      <p>Send Plus-Cross</p>
      <i class="fa-solid fa-plus fa-3x"></i>
    </button>
  </div>
  <div class="pt-2">
    <h2>Number Sender</h2>
    <p>Enter a number (0-99999) to send to the arduino.</p>
    <input type="number" id="numberInput" min="0" max="99999" value="0">
    <button class="btn btn-primary" onclick="sendNumber()">Send Number</button>
  
  <script>
    let serialPort;
    const connectButton = document.getElementById('connectButton');

    async function sendData(data) {
      if (!serialPort || !serialPort.writable) {
        console.error('Serial port not connected or not writable.');
        return;
      }

      // encodes the data being sent to the arduino port
      const encoder = new TextEncoder();
      const dataArray = encoder.encode(data);

      // writing to the serial port of the arduino
      const writer = serialPort.writable.getWriter();
      await writer.write(dataArray);
      writer.releaseLock();
      console.log('Data sent to Arduino:', data);
    }

    // connection for the arduino
    connectButton.addEventListener('click', async () => {
      try {
        serialPort = await navigator.serial.requestPort();
        await serialPort.open({ baudRate: 9600 });
        console.log('Serial port connected.');
        document.getElementById('connection-status').textContent = 'Connected';
      } catch (error) {
        console.error('Error connecting to serial port:', error);
        document.getElementById('connection-status').textContent = 'Connection failed';
      }
    });

    const numDictionary = {
      0: '011100',
      1: '100000',
      2: '101000',
      3: '110000',
      4: '110100',
      5: '100100',
      6: '111000',
      7: '111100',
      8: '101100',
      9: '011000'
    }

    const posDictionary = {
      1: '00',
      2: '03',
      3: '06',
      4: '40',
      5: '43',
      6: '46'
    }

    async function sendNumber() {
      if (!serialPort || !serialPort.writable) {
        console.error('Serial port not connected or not writable.');
        return;
      }

      const number = document.getElementById('numberInput').value;
      const numString = number.toString();
      const numDigits = numString.length;
      const gap = '0';
      const centerGap = '00000000'

      var outputString = "01";
      
      // adds the top of the number to the output string

      // starts with number sign, first digit, second digit



      
    }
  </script>
  </div>
</body>
</html>
